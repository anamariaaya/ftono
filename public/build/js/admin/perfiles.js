import{botones,pagAnterior,pagSiguiente,afterNav,btnContrato,nombre,email,cargo,telContacto,empresa,idFiscal,direccion,terms,privacy,divCheck,btnSubmit,paisContacto,telIndex,hiddenInput}from"./selectores.js";import{validarFormulario,imprimirAlerta}from"../base/funciones.js";import{readLang,readJSON}from"../base/funciones.js";export function formularioReg(){cargo.addEventListener("blur",validarFormulario),telContacto.addEventListener("blur",validarFormulario),empresa.addEventListener("blur",validarFormulario),idFiscal.addEventListener("blur",validarFormulario),direccion.addEventListener("blur",validarFormulario)}let paso=1;export function tabs(){botones.forEach(e=>{e.addEventListener("click",(function(e){paso=e.target.dataset.paso,cambiarSeccion(e),botonesPaginador()}))})}const secciones=document.querySelectorAll(".tabs__section");function cambiarSeccion(e){const t=document.querySelector("#paso-"+paso);t.classList.add("mostrar"),e.target.classList.add("active"),"paso-1"===t.id?(botones[0].classList.add("active"),botones[1].classList.remove("active"),botones[2].classList.remove("active"),secciones[0].classList.add("mostrar"),secciones[1].classList.remove("mostrar"),secciones[2].classList.remove("mostrar")):"paso-2"===t.id?(botones[1].classList.add("active"),botones[2].classList.remove("active"),secciones[1].classList.add("mostrar"),secciones[2].classList.remove("mostrar"),secciones[0].classList.remove("mostrar")):(botones[1].classList.add("active"),botones[2].classList.add("active"),secciones[2].classList.add("mostrar"),secciones[0].classList.remove("mostrar"),secciones[1].classList.remove("mostrar"))}function botonesPaginador(){switch(paso){case"1":pagAnterior.classList.add("ocultar"),pagSiguiente.classList.remove("ocultar"),afterNav.classList.remove("step2"),afterNav.classList.remove("step3"),pagSiguiente.textContent="Siguiente ➟",pagSiguiente.classList.remove("btn-tabs--disabled");break;case"2":pagAnterior.classList.remove("ocultar"),pagSiguiente.classList.remove("ocultar"),afterNav.classList.add("step2"),afterNav.classList.remove("step3"),pagSiguiente.classList.remove("btn-tabs--disabled"),pagSiguiente.textContent="Siguiente ➟";break;case"3":pagAnterior.classList.remove("ocultar"),pagSiguiente.textContent="Registrarse ✓",pagSiguiente.onclick=validarCheck,afterNav.classList.add("step3"),afterNav.classList.remove("step2"),btnContrato&&btnContrato.forEach(e=>{e.onclick=modalContrato})}}export function paginador(){pagAnterior.addEventListener("click",paginaAnterior),pagSiguiente.addEventListener("click",paginaSiguiente)}function validarCheck(e){if(e.preventDefault(),terms.checked)if(privacy.checked){const e=[cargo,telContacto,empresa,idFiscal,direccion];Array.from(e).every(e=>""!==e.value)?btnSubmit.click():alertaCheck("inputs")}else alertaCheck("privacy");else alertaCheck("terms")}async function alertaCheck(e){const t=document.createElement("div");t.classList.add("alerta__error");const a=document.querySelector(".alerta__error");a&&a.remove();const o=await readLang(),s=await readJSON();t.textContent=s[e][o],divCheck.appendChild(t),setTimeout(()=>{t.remove()},1e5)}function paginaSiguiente(){botones[1].classList.contains("active")?botones[2].classList.contains("active")||botones[2].click():botones[1].click()}function paginaAnterior(e){botones[2].classList.contains("active")?botones[1].click():botones[1].classList.contains("active")&&botones[0].click()}async function getContrato(e){try{const t=await fetch(e);return await t.json()}catch(e){console.log(e)}}async function modalContrato(e){e.preventDefault();const t=await readLang(),a=await readJSON(),o=document.querySelector("body");o.classList.add("overlay");const s=document.createElement("div");s.classList.add("register");const n=document.createElement("div");n.classList.add("register__modal");const i=document.createElement("button");let c;i.classList.add("register__btn-cerrar"),i.innerHTML='<i class="fas fa-times"></i>',i.onclick=cerrarModal,c="contrato-musical"===e.target.id?"http://localhost:3000/api/filmtono/c-musical":"http://localhost:3000/api/filmtono/c-artistico";const r=document.createElement("div"),l=await getContrato(c);r.innerHTML=l;const d=document.createElement("P");d.textContent=a.signature[t],d.classList.add("firma");const u=document.createElement("P");u.textContent=a.signatureInfo[t],u.classList.add("firma__info");const m=document.createElement("form"),p=document.createElement("canvas");p.id="canvasSignature",p.width=600,p.height=200,p.style.border="1px solid black",p.style.backgroundColor="white",p.style.margin="0 auto",p.style.display="block";const v=p.getContext("2d");v.fillStyle="white",v.strokeStyle="black",v.lineWidth=2,v.lineCap="round";let f=!1,g=0,L=0;function b(e){f=!0,e.touches?[g,L]=[e.touches[0].pageX-e.target.offsetLeft,e.touches[0].pageY-e.target.offsetTop]:[g,L]=[e.offsetX,e.offsetY]}function h(e){f&&(v.beginPath(),e.touches?(v.moveTo(g,L),v.lineTo(e.touches[0].pageX-e.target.offsetLeft,e.touches[0].pageY-e.target.offsetTop),[g,L]=[e.touches[0].pageX-e.target.offsetLeft,e.touches[0].pageY-e.target.offsetTop]):(v.moveTo(g,L),v.lineTo(e.offsetX,e.offsetY),[g,L]=[e.offsetX,e.offsetY]),v.stroke())}function C(){f=!1,v.beginPath()}p.addEventListener("mousedown",b),p.addEventListener("mousemove",h),p.addEventListener("mouseup",C),p.addEventListener("touchstart",b),p.addEventListener("touchmove",h),p.addEventListener("touchend",C);const k=document.createElement("button");k.classList.add("btn-contrato--optional"),k.textContent=a.clear[t],k.onclick=function(){v.clearRect(0,0,p.width,p.height),p.isCanvasBlank=!0},hiddenInput.value=p.toDataURL();const y=document.createElement("button");y.classList.add("btn-tabs","btn-tabs--disabled"),y.textContent="Guardar",y.onclick=canvasValidation(p,u,y),m.appendChild(p),n.appendChild(i),n.appendChild(r),n.appendChild(d),n.appendChild(u),n.appendChild(m),n.appendChild(k),n.appendChild(y),s.appendChild(n),o.appendChild(s),datosContrato(p),paisContrato()}function canvasValidation(e,t,a){e.addEventListener("mouseup",()=>{isCanvasBlank(e)||(a.classList.remove("btn-tabs--disabled"),a.onclick=cerrarModal)}),isCanvasBlank(e)&&(imprimirAlerta("signValidation","error",t),a.classList.add("btn-tabs--disabled"))}function isCanvasBlank(e){const t=e.getContext("2d");return!new Uint32Array(t.getImageData(0,0,e.width,e.height).data.buffer).some(e=>0!==e)}async function paisContrato(){if("0"!==paisContacto.value){const e=await readLang(),t=document.querySelector("#contract-pais"),a="https://restcountries.com/v3.1/alpha/"+paisContacto.value;fetch(a).then(e=>e.json()).then(a=>{t.textContent="es"===e?a[0].translations.spa.common:a[0].name.common})}}function datosContrato(e){const t=document.querySelector("#contract-empresa"),a=document.querySelector("#contract-nombre"),o=document.querySelector("#contract-id-fiscal"),s=document.querySelector("#contract-direccion"),n=document.querySelector("#contract-telefono"),i=document.querySelector("#contract-email"),c=document.getElementById("signature-img");t.textContent=empresa.value,a.textContent=nombre.value,o.textContent=idFiscal.value,s.textContent=direccion.value,n.textContent=telIndex.value+telContacto.value,i.textContent=email.value,e.addEventListener("click",()=>{c.src=e.toDataURL(),c.classList.remove("no-display")})}function cerrarModal(){const e=document.querySelector("body"),t=document.querySelector(".register");e.classList.remove("overlay"),t.remove()}
//# sourceMappingURL=perfiles.js.map
