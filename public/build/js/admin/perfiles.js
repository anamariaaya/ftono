import{botones,pagAnterior,pagSiguiente,afterNav,btnContrato,nombre,email,cargo,telContacto,empresa,idFiscal,direccion,terms,privacy,divCheck,btnSubmit,paisContacto,telIndex,hiddenInput,contratoMusical,confirmContrato}from"./selectores.js";import{validarFormulario,imprimirAlerta}from"../base/funciones.js";import{readLang,readJSON}from"../base/funciones.js";let checkMusical=!1;export function formularioReg(){cargo.addEventListener("blur",validarFormulario),telContacto.addEventListener("blur",validarFormulario),empresa.addEventListener("blur",validarFormulario),idFiscal.addEventListener("blur",validarFormulario),direccion.addEventListener("blur",validarFormulario)}let paso=1;export function tabs(){botones.forEach(t=>{t.addEventListener("click",(function(t){paso=t.target.dataset.paso,cambiarSeccion(t),botonesPaginador()}))})}const secciones=document.querySelectorAll(".tabs__section");function cambiarSeccion(t){const e=document.querySelector("#paso-"+paso);e.classList.add("mostrar"),t.target.classList.add("active"),"paso-1"===e.id?(botones[0].classList.add("active"),botones[1].classList.remove("active"),botones[2].classList.remove("active"),secciones[0].classList.add("mostrar"),secciones[1].classList.remove("mostrar"),secciones[2].classList.remove("mostrar")):"paso-2"===e.id?(botones[1].classList.add("active"),botones[2].classList.remove("active"),secciones[1].classList.add("mostrar"),secciones[2].classList.remove("mostrar"),secciones[0].classList.remove("mostrar")):(botones[1].classList.add("active"),botones[2].classList.add("active"),secciones[2].classList.add("mostrar"),secciones[0].classList.remove("mostrar"),secciones[1].classList.remove("mostrar"))}function botonesPaginador(){switch(paso){case"1":pagAnterior.classList.add("ocultar"),pagSiguiente.classList.remove("ocultar"),afterNav.classList.remove("step2"),afterNav.classList.remove("step3"),pagSiguiente.textContent="Siguiente ➟",pagSiguiente.classList.remove("btn-tabs--disabled");break;case"2":pagAnterior.classList.remove("ocultar"),pagSiguiente.classList.remove("ocultar"),afterNav.classList.add("step2"),afterNav.classList.remove("step3"),pagSiguiente.classList.remove("btn-tabs--disabled"),pagSiguiente.textContent="Siguiente ➟";break;case"3":pagAnterior.classList.remove("ocultar"),pagSiguiente.textContent="Registrarse ✓",pagSiguiente.onclick=validarCheck,afterNav.classList.add("step3"),afterNav.classList.remove("step2"),btnContrato&&btnContrato.forEach(t=>{t.onclick=modalContrato})}}export function paginador(){pagAnterior.addEventListener("click",paginaAnterior),pagSiguiente.addEventListener("click",paginaSiguiente)}function validarCheck(t){if(t.preventDefault(),terms.checked)if(privacy.checked)if(!1===checkMusical)alertaCheck("contract");else{const t=[cargo,telContacto,empresa,idFiscal,direccion];Array.from(t).every(t=>""!==t.value)?btnSubmit.click():alertaCheck("inputs")}else alertaCheck("privacy");else alertaCheck("terms")}async function alertaCheck(t){const e=document.createElement("div");e.classList.add("alerta__error");const a=document.querySelector(".alerta__error");a&&a.remove();const o=await readLang(),n=await readJSON();e.textContent=n[t][o],divCheck.appendChild(e),setTimeout(()=>{e.remove()},4e3)}function paginaSiguiente(){botones[1].classList.contains("active")?botones[2].classList.contains("active")||botones[2].click():botones[1].click()}function paginaAnterior(t){botones[2].classList.contains("active")?botones[1].click():botones[1].classList.contains("active")&&botones[0].click()}async function getContrato(t){try{const e=await fetch(t);return await e.json()}catch(t){console.log(t)}}async function modalContrato(t){t.preventDefault();const e=await readLang(),a=await readJSON(),o=document.querySelector("body");o.classList.add("overlay");const n=document.createElement("div");n.classList.add("register");const s=document.createElement("div");s.classList.add("register__modal");const c=document.createElement("button");let i;c.classList.add("register__btn-cerrar"),c.innerHTML='<i class="fas fa-times"></i>',c.onclick=cerrarModal,i="contrato-musical"===t.target.id?"http://localhost:3000/api/filmtono/c-musical":"http://localhost:3000/api/filmtono/c-artistico";const r=document.createElement("div"),l=await getContrato(i);r.innerHTML=l;const d=document.createElement("P");d.textContent=a.signature[e],d.classList.add("firma");const u=document.createElement("P");u.textContent=a.signatureInfo[e],u.classList.add("firma__info");const m=document.createElement("form"),p=document.createElement("canvas");p.id="canvasSignature",p.width=600,p.height=200,p.style.border="1px solid black",p.style.backgroundColor="white",p.style.margin="0 auto",p.style.display="block";const v=p.getContext("2d");v.fillStyle="white",v.strokeStyle="black",v.lineWidth=2,v.lineCap="round";let f=!1,g=0,L=0;function b(t){f=!0,t.touches?[g,L]=[t.touches[0].pageX-t.target.offsetLeft,t.touches[0].pageY-t.target.offsetTop]:[g,L]=[t.offsetX,t.offsetY]}function h(t){f&&(v.beginPath(),t.touches?(v.moveTo(g,L),v.lineTo(t.touches[0].pageX-t.target.offsetLeft,t.touches[0].pageY-t.target.offsetTop),[g,L]=[t.touches[0].pageX-t.target.offsetLeft,t.touches[0].pageY-t.target.offsetTop]):(v.moveTo(g,L),v.lineTo(t.offsetX,t.offsetY),[g,L]=[t.offsetX,t.offsetY]),v.stroke())}function C(){f=!1,v.beginPath()}p.addEventListener("mousedown",b),p.addEventListener("mousemove",h),p.addEventListener("mouseup",C),p.addEventListener("touchstart",b),p.addEventListener("touchmove",h),p.addEventListener("touchend",C);const y=document.createElement("button");y.classList.add("btn-contrato--optional"),y.textContent=a.clear[e],y.onclick=function(){v.clearRect(0,0,p.width,p.height),p.isCanvasBlank=!0,imprimirAlerta("signValidation","error",u),k.classList.add("btn-tabs--disabled")},hiddenInput.value=p.toDataURL();const k=document.createElement("button");k.classList.add("btn-tabs","btn-tabs--disabled"),k.textContent="Guardar",k.onclick=canvasValidation(p,u,k),m.appendChild(p),s.appendChild(c),s.appendChild(r),s.appendChild(d),s.appendChild(u),s.appendChild(m),s.appendChild(y),s.appendChild(k),n.appendChild(s),o.appendChild(n),datosContrato(p),paisContrato()}async function canvasValidation(t,e,a){const o=await readLang(),n=await readJSON();t.addEventListener("mouseup",()=>{isCanvasBlank(t)||(a.classList.remove("btn-tabs--disabled"),a.onclick=cerrarModal,contratoMusical.style.display="none",contratoMusical.remove(),confirmContrato.style.display="block",confirmContrato.textContent=n.confirm[o],checkMusical=!0)})}function isCanvasBlank(t){const e=t.getContext("2d");return!new Uint32Array(e.getImageData(0,0,t.width,t.height).data.buffer).some(t=>0!==t)}async function paisContrato(){if("0"!==paisContacto.value){const t=await readLang(),e=document.querySelector("#contract-pais"),a="https://restcountries.com/v3.1/alpha/"+paisContacto.value;fetch(a).then(t=>t.json()).then(a=>{e.textContent="es"===t?a[0].translations.spa.common:a[0].name.common})}}function datosContrato(t){const e=document.querySelector("#contract-empresa"),a=document.querySelector("#contract-nombre"),o=document.querySelector("#contract-id-fiscal"),n=document.querySelector("#contract-direccion"),s=document.querySelector("#contract-telefono"),c=document.querySelector("#contract-email"),i=document.getElementById("signature-img");e.textContent=empresa.value,a.textContent=nombre.value,o.textContent=idFiscal.value,n.textContent=direccion.value,s.textContent=telIndex.value+telContacto.value,c.textContent=email.value,t.addEventListener("click",()=>{i.src=t.toDataURL(),i.classList.remove("no-display")})}function cerrarModal(){const t=document.querySelector("body"),e=document.querySelector(".register");t.classList.remove("overlay"),e.remove()}
//# sourceMappingURL=perfiles.js.map
