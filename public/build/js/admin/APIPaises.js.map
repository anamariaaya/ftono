{"version":3,"sources":["admin/APIPaises.js"],"names":["validarFormulario","selectPais","paisContacto","indicativo","readLang","async","consultaPaises","url","resultado","fetch","mostrarPaises","json","error","console","log","datos","then","lang","forEach","pais","sort","a","b","translations","spa","common","option","document","createElement","value","cca2","textContent","appendChild","cloneNode","name","paisElegido","addEventListener","indicativoTel","e","target","respuesta","Object","keys","idd","length","root","suffix","suffixes","setAttribute"],"mappings":"OAASA,sBAAyB,8BACzBC,WAAYC,aAAcC,eAAkB,yBAC5CC,aAAe,8BAIjBC,eAAeC,iBAClB,IACI,IAAIC,EAAM,qCAIV,MAAMC,QAAkBC,MAAMF,GAE9BG,oBADoBF,EAAUG,QAEjC,MAAMC,GACHC,QAAQC,IAAIF,IAKpB,SAASF,cAAcK,GACnBX,WAAWY,KAAKC,IACI,OAATA,EACCF,EAAMG,QAAQC,IAEVJ,EAAMK,KAAK,CAACC,EAAGC,IACRD,EAAEE,aAAaC,IAAIC,OAASH,EAAEC,aAAaC,IAAIC,QACtC,EAETJ,EAAEE,aAAaC,IAAIC,OAASH,EAAEC,aAAaC,IAAIC,OACvC,EAEJ,GAGX,MAAMC,EAASC,SAASC,cAAc,UACtCF,EAAOG,MAAQV,EAAKW,KACpBJ,EAAOK,YAAcZ,EAAKI,aAAaC,IAAIC,OAC3CxB,WAAW+B,YAAYN,GACvBxB,aAAa8B,YAAYN,EAAOO,WAAU,MAG9ClB,EAAMG,QAAQC,IAEVJ,EAAMK,KAAK,CAACC,EAAGC,IACRD,EAAEa,KAAKT,OAASH,EAAEY,KAAKT,QACd,EAETJ,EAAEa,KAAKT,OAASH,EAAEY,KAAKT,OACf,EAEJ,GAIX,MAAMC,EAASC,SAASC,cAAc,UACtCF,EAAOG,MAAQV,EAAKW,KACpBJ,EAAOK,YAAcZ,EAAKe,KAAKT,OAC/BxB,WAAW+B,YAAYN,GACvBxB,aAAa8B,YAAYN,EAAOO,WAAU,eAOvD,SAASE,cACZlC,WAAWmC,iBAAiB,OAAQpC,mBACpCE,aAAakC,iBAAiB,OAAQpC,0BAGnC,SAASqC,gBACZnC,aAAakC,iBAAiB,UAAU,SAASE,GAC7C,GAAsB,KAAnBA,EAAEC,OAAOV,MAAa,CAErB,MAAMtB,EAAM,wCAAwC+B,EAAEC,OAAOV,MAC7DpB,MAAMF,GACDS,KAAKwB,GAAaA,EAAU7B,QAC5BK,KAAKD,IAGF,GADAF,QAAQC,MACgC,IAArC2B,OAAOC,KAAK3B,EAAM,GAAG4B,KAAKC,OACzBzC,WAAW0B,MAAQ,SACjB,CACF,MAAMgB,EAAO9B,EAAM,GAAG4B,IAAIE,KACpBC,EAAS/B,EAAM,GAAG4B,IAAII,SAAS,GACrC5C,WAAW0B,MAAQ,GAAGgB,IAAOC,IAC7B3C,WAAW6C,aAAa,WAAY,YACpC7C,WAAW6C,aAAa,QAAS,GAAGH,IAAOC","file":"APIPaises.js","sourcesContent":["import { validarFormulario } from \"../base/funciones.js\";\r\nimport { selectPais, paisContacto, indicativo } from \"./selectores.js\";\r\nimport  {readLang} from \"../base/funciones.js\";\r\n//import { validarFormulario } from '../base/funciones.js';\r\n\r\n\r\nexport async function consultaPaises(){\r\n    try{\r\n        let url = `https://restcountries.com/v3.1/all`;\r\n        // if(lang !== 'en'){\r\n        //     url += `&lang=${lang}`;\r\n        // }\r\n        const resultado = await fetch(url);\r\n        const datos = await resultado.json();\r\n        mostrarPaises(datos);\r\n    }catch(error){\r\n        console.log(error);\r\n    }\r\n}\r\n\r\n\r\nfunction mostrarPaises(datos){\r\n    readLang().then(lang => {\r\n            if(lang === 'es'){\r\n                datos.forEach(pais => {\r\n                    //ordenar los paises por orden alfabético\r\n                    datos.sort((a, b) => {\r\n                        if(a.translations.spa.common < b.translations.spa.common){\r\n                            return -1;\r\n                        }\r\n                        if(a.translations.spa.common > b.translations.spa.common){\r\n                            return 1;\r\n                        }\r\n                        return 0;\r\n                    });\r\n                    //crear option con el nombre del pais\r\n                    const option = document.createElement('option');\r\n                    option.value = pais.cca2;\r\n                    option.textContent = pais.translations.spa.common;\r\n                    selectPais.appendChild(option);\r\n                    paisContacto.appendChild(option.cloneNode(true));\r\n                });\r\n            } else{\r\n                datos.forEach(pais => {\r\n                    //ordenar los países por orden alfabético\r\n                    datos.sort((a, b) => {\r\n                        if(a.name.common < b.name.common){\r\n                            return -1;\r\n                        }\r\n                        if(a.name.common > b.name.common){\r\n                            return 1;\r\n                        }\r\n                        return 0;\r\n                    });\r\n\r\n                    //crear option con el nombre del pais\r\n                    const option = document.createElement('option');\r\n                    option.value = pais.cca2;\r\n                    option.textContent = pais.name.common;\r\n                    selectPais.appendChild(option);  \r\n                    paisContacto.appendChild(option.cloneNode(true));\r\n                });\r\n            }\r\n        }\r\n    );\r\n}\r\n\r\nexport function paisElegido(){\r\n    selectPais.addEventListener('blur', validarFormulario);\r\n    paisContacto.addEventListener('blur', validarFormulario);\r\n}\r\n\r\nexport function indicativoTel(){\r\n    paisContacto.addEventListener('change', function(e){\r\n        if(e.target.value !== ''){\r\n            //consultar API para obtener el indicativo\r\n            const url = `https://restcountries.com/v3.1/alpha/${e.target.value}`;\r\n            fetch(url)\r\n                .then(respuesta => respuesta.json())\r\n                .then(datos => {      \r\n                    //leer longitud de un array\r\n                    console.log();              \r\n                    if(Object.keys(datos[0].idd).length === 0){\r\n                        indicativo.value = '0-';\r\n                    } else{\r\n                        const root = datos[0].idd.root;\r\n                        const suffix = datos[0].idd.suffixes[0];\r\n                        indicativo.value = `${root}${suffix}`;\r\n                        indicativo.setAttribute('readonly', 'readonly');\r\n                        indicativo.setAttribute('value', `${root}${suffix}`);\r\n                    }\r\n                });\r\n        }\r\n    });\r\n}\r\n\r\n"]}