{"version":3,"sources":["filmtono/contratos.js"],"names":["contratos","contratosContainer","contratosSearch","imprimirAlerta","readLang","readJSON","eliminarItem","async","consultaContratos","resultado","fetch","window","location","origin","mostrarContratos","json","error","console","log","datos","lang","alerts","forEach","contrato","tipoContrato","nombre_doc","split","id","nombre","apellido","empresa","fecha","cardLink","document","createElement","href","cardContrato","classList","add","cardInfo","nameInfo","titleNombre","textContent","nombreCompleto","appendChild","empresaInfo","titleEmpresa","empresaContrato","tipoInfo","titleTipo","tipo","fechaInfo","titleFecha","fechaContrato","cardActions","btnEliminar","onclick","iconEliminar","filtrarContratos","addEventListener","e","texto","target","value","toLowerCase","querySelectorAll","card","indexOf","style","display","marginRight","gap"],"mappings":"OAAQA,UAAWC,mBAAoBC,oBAAsB,yBACrDC,eAAgBC,SAAUC,SAAUC,iBAAmB,8BAExDC,eAAeC,oBAClB,IACI,MAAMC,QAAkBC,MAAMC,OAAOC,SAASC,OAAO,2BAGtDC,uBAFqBL,EAAUM,QAGjC,MAAMC,GACHC,QAAQC,IAAIF,IAIpBT,eAAeO,iBAAiBK,GAC5B,MAAMC,QAAahB,WACbiB,QAAehB,WAErBc,EAAMG,QAAQC,IAEV,MAAMC,EAAeD,EAASE,WAAWC,MAAM,KAAK,IAC/CC,GAACA,EAAEC,OAAEA,EAAMC,SAAEA,EAAQC,QAAEA,EAAOC,MAAEA,EAAKN,WAAEA,GAAcF,EAGpDS,EAAWC,SAASC,cAAc,KACxCF,EAASG,KAAO,kCAAkCR,EAAG,SAASH,EAG9D,MAAMY,EAAeH,SAASC,cAAc,OAC5CE,EAAaC,UAAUC,IAAI,eAE3B,MAAMC,EAAWN,SAASC,cAAc,OACxCK,EAASF,UAAUC,IAAI,eAEvB,MAAME,EAAWP,SAASC,cAAc,OACxCM,EAASH,UAAUC,IAAI,oBAEvB,MAAMG,EAAcR,SAASC,cAAc,KAC3CO,EAAYC,YAAcrB,EAAO,uBAAuBD,GAAM,IAC9DqB,EAAYJ,UAAUC,IAAI,cAAe,qBAEzC,MAAMK,EAAiBV,SAASC,cAAc,KAC9CS,EAAeD,YAAc,GAAGd,KAAUC,IAC1Cc,EAAeN,UAAUC,IAAI,eAE7BE,EAASI,YAAYH,GACrBD,EAASI,YAAYD,GAErB,MAAME,EAAcZ,SAASC,cAAc,OAC3CW,EAAYR,UAAUC,IAAI,oBAE1B,MAAMQ,EAAeb,SAASC,cAAc,KAC5CY,EAAaJ,YAAcrB,EAA0B,kBAAED,GAAM,IAC7D0B,EAAaT,UAAUC,IAAI,cAAe,qBAE1C,MAAMS,EAAkBd,SAASC,cAAc,KAC/Ca,EAAgBL,YAAcZ,EAC9BiB,EAAgBV,UAAUC,IAAI,eAE9BO,EAAYD,YAAYE,GACxBD,EAAYD,YAAYG,GAExB,MAAMC,EAAWf,SAASC,cAAc,OACxCc,EAASX,UAAUC,IAAI,oBAEvB,MAAMW,EAAYhB,SAASC,cAAc,KACzCe,EAAUP,YAAcrB,EAAuB,eAAED,GAAM,IACvD6B,EAAUZ,UAAUC,IAAI,cAAe,qBAEvC,MAAMY,EAAOjB,SAASC,cAAc,KACpCgB,EAAKR,YAAclB,EACnB0B,EAAKb,UAAUC,IAAI,eAEnBU,EAASJ,YAAYK,GACrBD,EAASJ,YAAYM,GAErB,MAAMC,EAAYlB,SAASC,cAAc,OACzCiB,EAAUd,UAAUC,IAAI,oBAExB,MAAMc,EAAanB,SAASC,cAAc,KAC1CkB,EAAWV,YAAcrB,EAAwB,gBAAED,GAAM,IACzDgC,EAAWf,UAAUC,IAAI,cAAe,qBAExC,MAAMe,EAAgBpB,SAASC,cAAc,KAC7CmB,EAAcX,YAAcX,EAC5BsB,EAAchB,UAAUC,IAAI,eAE5Ba,EAAUP,YAAYQ,GACtBD,EAAUP,YAAYS,GAGtB,MAAMC,EAAcrB,SAASC,cAAc,OAC3CoB,EAAYjB,UAAUC,IAAI,kBAE1B,MAAMiB,EAActB,SAASC,cAAc,UAC3CqB,EAAYlB,UAAUC,IAAI,cAC1BiB,EAAY5B,GAAKA,EACjB4B,EAAYC,QAAUlD,aAEtB,MAAMmD,EAAexB,SAASC,cAAc,KAC5CuB,EAAapB,UAAUC,IAAI,WAAY,eAAgB,YAEvDiB,EAAYX,YAAYa,GACxBH,EAAYV,YAAYW,GAGxBhB,EAASK,YAAYJ,GACrBD,EAASK,YAAYC,GACrBN,EAASK,YAAYI,GACrBT,EAASK,YAAYO,GAErBf,EAAaQ,YAAYL,GACzBH,EAAaQ,YAAYU,GAEzBtB,EAASY,YAAYR,GACrBnC,mBAAmB2C,YAAYZ,KAEnC0B,mBAGJ,SAASA,mBACLxD,gBAAgByD,iBAAiB,QAASC,IACtC,MAAMC,EAAQD,EAAEE,OAAOC,MAAMC,cACf/B,SAASgC,iBAAiB,gBAElC3C,QAAQ4C,KAEoB,IADfA,EAAKxB,YAAYsB,cACtBG,QAAQN,IACdK,EAAKE,MAAMC,QAAU,OACrBH,EAAKE,MAAME,YAAc,OACzBrE,mBAAmBmE,MAAMG,IAAM,KAE/BL,EAAKE,MAAMC,QAAU","file":"contratos.js","sourcesContent":["import {contratos, contratosContainer, contratosSearch} from './selectores.js';\r\nimport {imprimirAlerta, readLang, readJSON, eliminarItem} from '../base/funciones.js';\r\n\r\nexport async function consultaContratos(){\r\n    try{\r\n        const resultado = await fetch(window.location.origin+'/api/filmtono/contracts');\r\n        const datos = await resultado.json();\r\n    //    console.log(datos);\r\n       mostrarContratos(datos);\r\n    }catch(error){\r\n        console.log(error);\r\n    }\r\n}\r\n\r\nasync function mostrarContratos(datos){\r\n    const lang = await readLang();\r\n    const alerts = await readJSON();\r\n\r\n    datos.forEach(contrato => {\r\n        //extract the type of contract from the name of the file nombre_doc\r\n        const tipoContrato = contrato.nombre_doc.split('-')[2];\r\n        const{id, nombre, apellido, empresa, fecha, nombre_doc} = contrato;\r\n\r\n        //Create the card to wrap the contract info and actions\r\n        const cardLink = document.createElement('a');\r\n        cardLink.href = '/filmtono/contracts/current?id='+id+'&type='+tipoContrato;\r\n\r\n        //Create the info section\r\n        const cardContrato = document.createElement('div');\r\n        cardContrato.classList.add('cards__card');\r\n\r\n        const cardInfo = document.createElement('div');\r\n        cardInfo.classList.add('cards__info');\r\n\r\n        const nameInfo = document.createElement('div');\r\n        nameInfo.classList.add('cards__info--div');\r\n\r\n        const titleNombre = document.createElement('p');\r\n        titleNombre.textContent = alerts['contracts_user-name'][lang]+':';\r\n        titleNombre.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const nombreCompleto = document.createElement('p');\r\n        nombreCompleto.textContent = `${nombre} ${apellido}`;\r\n        nombreCompleto.classList.add('cards__text');\r\n        \r\n        nameInfo.appendChild(titleNombre);\r\n        nameInfo.appendChild(nombreCompleto);\r\n\r\n        const empresaInfo = document.createElement('div');\r\n        empresaInfo.classList.add('cards__info--div');\r\n\r\n        const titleEmpresa = document.createElement('p');\r\n        titleEmpresa.textContent = alerts['contracts_empresa'][lang]+':';\r\n        titleEmpresa.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const empresaContrato = document.createElement('p');\r\n        empresaContrato.textContent = empresa;\r\n        empresaContrato.classList.add('cards__text');\r\n\r\n        empresaInfo.appendChild(titleEmpresa);\r\n        empresaInfo.appendChild(empresaContrato);\r\n\r\n        const tipoInfo = document.createElement('div');\r\n        tipoInfo.classList.add('cards__info--div');\r\n\r\n        const titleTipo = document.createElement('p');\r\n        titleTipo.textContent = alerts['contracts_type'][lang]+':';\r\n        titleTipo.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const tipo = document.createElement('p');\r\n        tipo.textContent = tipoContrato;\r\n        tipo.classList.add('cards__text');\r\n\r\n        tipoInfo.appendChild(titleTipo);\r\n        tipoInfo.appendChild(tipo);\r\n\r\n        const fechaInfo = document.createElement('div');\r\n        fechaInfo.classList.add('cards__info--div');\r\n\r\n        const titleFecha = document.createElement('p');\r\n        titleFecha.textContent = alerts['contracts_fecha'][lang]+':';\r\n        titleFecha.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const fechaContrato = document.createElement('p');\r\n        fechaContrato.textContent = fecha;\r\n        fechaContrato.classList.add('cards__text');\r\n\r\n        fechaInfo.appendChild(titleFecha);\r\n        fechaInfo.appendChild(fechaContrato);\r\n\r\n        //Create the actions section\r\n        const cardActions = document.createElement('div');\r\n        cardActions.classList.add('cards__actions');\r\n\r\n        const btnEliminar = document.createElement('button');\r\n        btnEliminar.classList.add('btn-delete');\r\n        btnEliminar.id = id;\r\n        btnEliminar.onclick = eliminarItem;\r\n\r\n        const iconEliminar = document.createElement('i');\r\n        iconEliminar.classList.add('fa-solid', 'fa-trash-can', 'no-click');\r\n\r\n        btnEliminar.appendChild(iconEliminar);\r\n        cardActions.appendChild(btnEliminar);\r\n\r\n\r\n        cardInfo.appendChild(nameInfo);\r\n        cardInfo.appendChild(empresaInfo);\r\n        cardInfo.appendChild(tipoInfo);\r\n        cardInfo.appendChild(fechaInfo);\r\n\r\n        cardContrato.appendChild(cardInfo);\r\n        cardContrato.appendChild(cardActions);\r\n\r\n        cardLink.appendChild(cardContrato);\r\n        contratosContainer.appendChild(cardLink);\r\n    });\r\n    filtrarContratos();\r\n}\r\n\r\nfunction filtrarContratos(){\r\n    contratosSearch.addEventListener('input', e => {\r\n        const texto = e.target.value.toLowerCase();\r\n        const cards = document.querySelectorAll('.cards__card');\r\n\r\n        cards.forEach(card => {\r\n            const nombre = card.textContent.toLowerCase();\r\n            if(nombre.indexOf(texto) !== -1){\r\n                card.style.display = 'flex';\r\n                card.style.marginRight = '2rem';\r\n                contratosContainer.style.gap = '0';\r\n            }else{\r\n                card.style.display = 'none';\r\n            }\r\n        });\r\n    }); \r\n}"]}