{"version":3,"sources":["filmtono/contratos.js"],"names":["contratosContainer","contratosSearch","readLang","readJSON","eliminarItem","async","consultaContratos","resultado","fetch","window","location","origin","mostrarContratos","json","error","console","log","datos","lang","alerts","forEach","contrato","tipoContrato","nombre_doc","split","id","nombre","apellido","empresa","fecha","cardLink","document","createElement","classList","add","href","cardContrato","cardInfo","nameInfo","titleNombre","textContent","nombreCompleto","appendChild","empresaInfo","titleEmpresa","empresaContrato","tipoInfo","titleTipo","tipo","fechaInfo","titleFecha","fechaContrato","fechaFormat","Date","toLocaleDateString","year","month","day","cardActions","btnEliminar","value","dataset","type","item","role","onclick","iconEliminar","filtrarContratos","addEventListener","e","texto","target","toLowerCase","querySelectorAll","card","indexOf","style","display","marginRight","columnGap"],"mappings":"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","file":"contratos.js","sourcesContent":["import {contratosContainer, contratosSearch} from './selectores.js';\r\nimport {readLang, readJSON, eliminarItem} from '../base/funciones.js';\r\n\r\nexport async function consultaContratos(){\r\n    try{\r\n        const resultado = await fetch(window.location.origin+'/api/filmtono/contracts');\r\n        const datos = await resultado.json();\r\n       mostrarContratos(datos);\r\n    }catch(error){\r\n        console.log(error);\r\n    }\r\n}\r\n\r\nasync function mostrarContratos(datos){\r\n    const lang = await readLang();\r\n    const alerts = await readJSON();\r\n\r\n    datos.forEach(contrato => {\r\n        //extract the type of contract from the name of the file nombre_doc\r\n        const tipoContrato = contrato.nombre_doc.split('-')[2];\r\n        const{id, nombre, apellido, empresa, fecha} = contrato;\r\n\r\n        //Create the card to wrap the contract info and actions\r\n        const cardLink = document.createElement('a');\r\n        cardLink.classList.add('cards__link');\r\n        cardLink.href = '/filmtono/contracts/current?id='+id+'&type='+tipoContrato;\r\n\r\n        //Create the info section\r\n        const cardContrato = document.createElement('div');\r\n        cardContrato.classList.add('cards__card');\r\n\r\n        const cardInfo = document.createElement('div');\r\n        cardInfo.classList.add('cards__info');\r\n\r\n        const nameInfo = document.createElement('div');\r\n        nameInfo.classList.add('cards__info--div');\r\n\r\n        const titleNombre = document.createElement('p');\r\n        titleNombre.textContent = alerts['contracts_user-name'][lang]+':';\r\n        titleNombre.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const nombreCompleto = document.createElement('p');\r\n        nombreCompleto.textContent = `${nombre} ${apellido}`;\r\n        nombreCompleto.classList.add('cards__text');\r\n        \r\n        nameInfo.appendChild(titleNombre);\r\n        nameInfo.appendChild(nombreCompleto);\r\n\r\n        const empresaInfo = document.createElement('div');\r\n        empresaInfo.classList.add('cards__info--div');\r\n\r\n        const titleEmpresa = document.createElement('p');\r\n        titleEmpresa.textContent = alerts['contracts_empresa'][lang]+':';\r\n        titleEmpresa.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const empresaContrato = document.createElement('p');\r\n        empresaContrato.textContent = empresa;\r\n        empresaContrato.classList.add('cards__text');\r\n\r\n        empresaInfo.appendChild(titleEmpresa);\r\n        empresaInfo.appendChild(empresaContrato);\r\n\r\n        const tipoInfo = document.createElement('div');\r\n        tipoInfo.classList.add('cards__info--div');\r\n\r\n        const titleTipo = document.createElement('p');\r\n        titleTipo.textContent = alerts['contracts_type'][lang]+':';\r\n        titleTipo.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const tipo = document.createElement('p');\r\n        if(tipoContrato === 'music'){\r\n            tipo.textContent = alerts['contracts_type-music'][lang];\r\n        }else{\r\n            tipo.textContent = alerts['contracts_type-artistic'][lang];\r\n        }\r\n        tipo.classList.add('cards__text');\r\n\r\n        tipoInfo.appendChild(titleTipo);\r\n        tipoInfo.appendChild(tipo);\r\n\r\n        const fechaInfo = document.createElement('div');\r\n        fechaInfo.classList.add('cards__info--div');\r\n\r\n        const titleFecha = document.createElement('p');\r\n        titleFecha.textContent = alerts['contracts_fecha'][lang]+':';\r\n        titleFecha.classList.add('cards__text', 'cards__text--span');\r\n\r\n        const fechaContrato = document.createElement('p');\r\n        //add date as day/month/year\r\n        const date = new Date(fecha);\r\n        const options = {year: 'numeric', month: 'short', day: 'numeric'};\r\n        const fechaFormat = date.toLocaleDateString(lang, options);\r\n        fechaContrato.textContent = fechaFormat;\r\n        fechaContrato.classList.add('cards__text');\r\n\r\n        fechaInfo.appendChild(titleFecha);\r\n        fechaInfo.appendChild(fechaContrato);\r\n\r\n        //Create the actions section\r\n        const cardActions = document.createElement('div');\r\n        cardActions.classList.add('cards__actions');\r\n\r\n        const btnEliminar = document.createElement('button');\r\n        btnEliminar.classList.add('btn-delete');\r\n        btnEliminar.id = 'eliminar';\r\n        btnEliminar.value = id;\r\n        btnEliminar.dataset.type = tipoContrato;\r\n        btnEliminar.dataset.item = 'contracts';\r\n        btnEliminar.dataset.role = 'filmtono';\r\n        btnEliminar.onclick = eliminarItem;\r\n\r\n        const iconEliminar = document.createElement('i');\r\n        iconEliminar.classList.add('fa-solid', 'fa-trash-can', 'no-click');\r\n\r\n        btnEliminar.appendChild(iconEliminar);\r\n        cardActions.appendChild(btnEliminar);\r\n\r\n\r\n        cardInfo.appendChild(nameInfo);\r\n        cardInfo.appendChild(empresaInfo);\r\n        cardInfo.appendChild(tipoInfo);\r\n        cardInfo.appendChild(fechaInfo);\r\n\r\n        cardContrato.appendChild(cardInfo);\r\n        cardContrato.appendChild(cardActions);\r\n\r\n        cardLink.appendChild(cardContrato);\r\n        contratosContainer.appendChild(cardLink);\r\n    });\r\n    filtrarContratos();\r\n}\r\n\r\nfunction filtrarContratos(){\r\n    contratosSearch.addEventListener('input', e => {\r\n        const texto = e.target.value.toLowerCase();\r\n        const cards = document.querySelectorAll('.cards__card');\r\n\r\n        cards.forEach(card => {\r\n            const nombre = card.textContent.toLowerCase();\r\n            if(nombre.indexOf(texto) !== -1){\r\n                card.style.display = 'flex';\r\n                card.style.marginRight = '2rem';\r\n                contratosContainer.style.columnGap = '0';\r\n            }else{\r\n                card.style.display = 'none';\r\n            }\r\n        });\r\n    }); \r\n}"]}