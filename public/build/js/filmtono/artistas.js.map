{"version":3,"sources":["filmtono/artistas.js"],"names":["artistasInput","portada","artistaSecundario","btnAgregar","readLang","readJSON","validarFormulario","styleDatalist","forEach","input","onfocus","nextElementSibling","style","display","option","options","classList","add","onclick","value","oninput","text","toUpperCase","indexOf","styleFileInput","then","lang","cover","setAttribute","artistasSecundarios","artistasList","artistaId","id","artistaName","name","textContent","agregarArtistaSecundario","div","document","createElement","parentElement","insertBefore","querySelector","querySelectorAll","artista","remove","appendChild","p","btnEliminar","removeChild","addEventListener","e","artistasArray","push","toString","console","log","async","addArtist","alerts","preventDefault","body","divModal","modal","btnCerrar","innerHTML","cerrarModal","form","autocomplete","h2","divInput","label","htmlFor","type","placeholder","sendBtn","enviarArtista","nombre","data","FormData","append","url","window","location","origin","respuesta","fetch","method","mode","json","resultado","alert","reload","error"],"mappings":"OAASA,cAAeC,QAASC,kBAAmBC,eAAkB,yBAC7DC,SAAUC,SAAUC,sBAAwB,8BAG9C,SAASC,gBACZP,cAAcQ,QAAQC,IAClBA,EAAMC,QAAU,WACZD,EAAME,mBAAmBC,MAAMC,QAAU,SAE7C,IAAI,IAAIC,KAAUL,EAAME,mBAAmBI,QACvCD,EAAOE,UAAUC,IAAI,UACrBH,EAAOI,QAAU,WACbT,EAAMU,MAAQL,EAAOK,MACrBV,EAAME,mBAAmBC,MAAMC,QAAU,QAIjDJ,EAAMW,QAAU,WACZ,MAAMC,EAAOZ,EAAMU,MAAMG,cACzB,IAAK,IAAIR,KAAUL,EAAME,mBAAmBI,QACrCD,EAAOK,MAAMG,cAAcC,QAAQF,IAAS,EAC/CP,EAAOF,MAAMC,QAAU,QAEvBC,EAAOF,MAAMC,QAAU,QAI/BJ,EAAMS,QAAU,WACZT,EAAME,mBAAmBC,MAAMC,QAAU,kBAK9C,SAASW,iBACZpB,WAAWqB,KAAKC,IACA,OAATA,EACCzB,QAAQO,QAAQmB,IACZA,EAAMC,aAAa,YAAa,2BAGpC3B,QAAQO,QAAQmB,IACZA,EAAMC,aAAa,YAAa,4BAMzC,SAASC,sBACZ,IAAIC,EAAe5B,kBAAkBS,mBACrC,IAAI,IAAIG,KAAUgB,EAAaf,QAC3BD,EAAOI,QAAU,WACb,IAAIa,EAAY7B,kBAAkB8B,GAC9BC,EAAc/B,kBAAkBgC,KAEpCH,EAAYjB,EAAOK,MACnBc,EAAcnB,EAAOqB,YACrBC,yBAAyBL,EAAWE,GACpCH,EAAalB,MAAMC,QAAU,QAEjCX,kBAAkBkB,QAAU,WACxB,MAAMC,EAAOnB,kBAAkBiB,MAAMG,cACrC,IAAK,IAAIR,KAAUgB,EAAaf,QACzBD,EAAOK,MAAMG,cAAcC,QAAQF,IAAS,EAC/CP,EAAOF,MAAMC,QAAU,QAEvBC,EAAOF,MAAMC,QAAU,QAOnC,MAAMwB,EAAMC,SAASC,cAAc,OACnCF,EAAIrB,UAAUC,IAAI,iCAClBf,kBAAkBsC,cAAcC,aAAaJ,EAAKnC,mBAGtD,SAASkC,yBAAyBL,EAAWE,GAIzC,MAAMI,EAAMC,SAASI,cAAc,kCAGfJ,SAASK,iBAAiB,qCAElCnC,QAAQoC,IACbA,EAAQZ,KAAOD,EACda,EAAQC,SAERR,EAAIS,YAAYF,KAKxB,MAAMG,EAAIT,SAASC,cAAc,KACjCQ,EAAE/B,UAAUC,IAAI,oCAChB8B,EAAEf,GAAKD,EACPgB,EAAEZ,YAAcF,EAEhB,MAAMe,EAAcV,SAASC,cAAc,UAC3CS,EAAYhC,UAAUC,IAAI,gBAC1B+B,EAAYb,YAAc,IAC1Ba,EAAYhB,GAAKD,EACjBiB,EAAY9B,QAAU,WAClBmB,EAAIY,YAAYF,IAIpBA,EAAED,YAAYE,GACdX,EAAIS,YAAYC,GAIET,SAASI,cAAc,gBAC/BQ,iBAAiB,SAAS,SAASC,GAEzC,MAAMC,EAAgB,GACLd,SAASK,iBAAiB,qCAClCnC,QAAQoC,IACbQ,EAAcC,KAAKT,EAAQZ,MAE/B,MAAMhC,EAAgBsC,SAASI,cAAc,0BAC7C1C,EAAcmB,MAAQiC,EAAcE,WACpCC,QAAQC,IAAIxD,EAAcmB,iBAI3BsC,eAAeC,YAClB,MAAMhC,QAAatB,WACbuD,QAAetD,WACrBF,WAAW+C,iBAAiB,SAAS,SAASC,GAC1CA,EAAES,iBAIF,MAAMC,EAAOvB,SAASI,cAAc,QACpCmB,EAAK7C,UAAUC,IAAI,WAEnB,MAAM6C,EAAWxB,SAASC,cAAc,OACxCuB,EAAS9C,UAAUC,IAAI,YAEvB,MAAM8C,EAAQzB,SAASC,cAAc,OACrCwB,EAAM/C,UAAUC,IAAI,mBAEpB,MAAM+C,EAAY1B,SAASC,cAAc,UACzCyB,EAAUhD,UAAUC,IAAI,wBACxB+C,EAAUC,UAAY,+BACtBD,EAAU9C,QAAUgD,YAGpB,MAAMC,EAAO7B,SAASC,cAAc,QACpC4B,EAAKnD,UAAUC,IAAI,kBACnBkD,EAAKnC,GAAK,eACVmC,EAAKC,aAAe,MAEpB,MAAMC,EAAK/B,SAASC,cAAc,MAClC8B,EAAGrD,UAAUC,IAAI,mBACjBoD,EAAGlC,YAAcwB,EAAkB,UAAEjC,GAErC,MAAM4C,EAAWhC,SAASC,cAAc,OACxC+B,EAAStD,UAAUC,IAAI,eAEvB,MAAMsD,EAAQjC,SAASC,cAAc,SACrCgC,EAAMvD,UAAUC,IAAI,sBACpBsD,EAAMC,QAAU,SAChBD,EAAMpC,YAAcwB,EAAa,KAAEjC,GAEnC,MAAMjB,EAAQ6B,SAASC,cAAc,SACrC9B,EAAMO,UAAUC,IAAI,sBACpBR,EAAMgE,KAAO,OACbhE,EAAMyB,KAAO,SACbzB,EAAMuB,GAAK,iBACXvB,EAAMyC,iBAAiB,OAAQ5C,mBAC/BG,EAAMiE,YAAcf,EAAa,KAAEjC,GAEnC,MAAMiD,EAAUrC,SAASC,cAAc,SACvCoC,EAAQ3D,UAAUC,IAAI,cACtB0D,EAAQF,KAAO,SACfE,EAAQxD,MAAQwC,EAAY,IAAEjC,GAC9BiD,EAAQzD,QAAU0D,cAGlBN,EAASxB,YAAYyB,GACrBD,EAASxB,YAAYrC,GACrB0D,EAAKrB,YAAYuB,GACjBF,EAAKrB,YAAYwB,GACjBH,EAAKrB,YAAY6B,GACjBZ,EAAMjB,YAAYkB,GAClBD,EAAMjB,YAAYqB,GAElBL,EAAShB,YAAYiB,GACrBF,EAAKf,YAAYgB,MAKzBL,eAAemB,gBACX,MACMC,EADQvC,SAASI,cAAc,mBAChBvB,MACf2D,EAAO,IAAIC,SAEjBD,EAAKE,OAAO,SAAUH,GAEtB,IAEI,MAAMI,EAAMC,OAAOC,SAASC,OAAO,0BAE7BC,QAAkBC,MAAML,EAAK,CAC/BM,OAAQ,OACR1B,KAAMiB,EACNU,KAAM,YAKV,UAFwBH,EAAUI,QAErBC,UAAU,CACnB,MAAMhE,QAAatB,WACnBmD,QAAQC,IAAI9B,GACA,OAATA,EACCiE,MAAM,kCAENA,MAAM,6BAEVT,OAAOC,SAASS,UAEvB,MAAMC,GAES,aADOzF,WAEfuF,MAAM,iBAENA,MAAM,uBAKlB,SAASzB,cACL,MAAML,EAAOvB,SAASI,cAAc,QAC9BqB,EAAQzB,SAASI,cAAc,aACrCmB,EAAK7C,UAAU6B,OAAO,WACtBkB,EAAMlB","file":"artistas.js","sourcesContent":["import { artistasInput, portada, artistaSecundario, btnAgregar } from \"./selectores.js\";\r\nimport  {readLang, readJSON, validarFormulario} from \"../base/funciones.js\";\r\n\r\n\r\nexport function styleDatalist(){\r\n    artistasInput.forEach(input => {\r\n        input.onfocus = function(){\r\n            input.nextElementSibling.style.display = 'block';\r\n        }\r\n        for(let option of input.nextElementSibling.options){\r\n            option.classList.add('option');\r\n            option.onclick = function(){\r\n                input.value = option.value;\r\n                input.nextElementSibling.style.display = 'none';\r\n            }\r\n        }\r\n        //filter options on input\r\n        input.oninput = function(){\r\n            const text = input.value.toUpperCase();\r\n            for (let option of input.nextElementSibling.options) {\r\n                if(option.value.toUpperCase().indexOf(text) > -1){\r\n                option.style.display = \"block\";\r\n            }else{\r\n                option.style.display = \"none\";\r\n                }\r\n            };\r\n        }\r\n        input.onclick = function(){\r\n            input.nextElementSibling.style.display = 'block';\r\n        }\r\n    });\r\n}\r\n\r\nexport function styleFileInput(){\r\n    readLang().then(lang => {\r\n        if(lang === 'es'){\r\n            portada.forEach(cover => {\r\n                cover.setAttribute('data-text', 'Selecciona un archivo');\r\n            });\r\n        } else{\r\n            portada.forEach(cover => {\r\n                cover.setAttribute('data-text', 'Select a file');\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nexport function artistasSecundarios(){\r\n    let artistasList = artistaSecundario.nextElementSibling;\r\n    for(let option of artistasList.options){        \r\n        option.onclick = function(){\r\n            let artistaId = artistaSecundario.id;\r\n            let artistaName = artistaSecundario.name;\r\n            \r\n            artistaId = option.value;\r\n            artistaName = option.textContent;\r\n            agregarArtistaSecundario(artistaId, artistaName);   \r\n            artistasList.style.display = 'none';\r\n        }\r\n        artistaSecundario.oninput = function(){\r\n            const text = artistaSecundario.value.toUpperCase();\r\n            for (let option of artistasList.options) {\r\n                if(option.value.toUpperCase().indexOf(text) > -1){\r\n                option.style.display = \"block\";\r\n            }else{\r\n                option.style.display = \"none\";\r\n                }\r\n            };\r\n        }\r\n\r\n    }\r\n    \r\n    const div = document.createElement('div');\r\n    div.classList.add('form__custom__input--artistas');\r\n    artistaSecundario.parentElement.insertBefore(div, artistaSecundario);\r\n}\r\n\r\nfunction agregarArtistaSecundario(artistaId, artistaName){\r\n    //crear un objeto con keys id y name para almacenar los artistas\r\n\r\n    //crear el div\r\n    const div = document.querySelector('.form__custom__input--artistas');\r\n\r\n    //Comprobar que el artista no estÃ© ya en el div\r\n    const artistasDiv = document.querySelectorAll('.form__custom__input--artistas__p');\r\n\r\n    artistasDiv.forEach(artista => {\r\n        if(artista.id === artistaId){\r\n            artista.remove();\r\n        }else{\r\n            div.appendChild(artista);            \r\n        }\r\n    });\r\n    //crear el parrafo con el nombre del artista\r\n\r\n    const p = document.createElement('p');\r\n    p.classList.add('form__custom__input--artistas__p');\r\n    p.id = artistaId;\r\n    p.textContent = artistaName;\r\n    //crear el boton de eliminar\r\n    const btnEliminar = document.createElement('button');\r\n    btnEliminar.classList.add('btn-eliminar');\r\n    btnEliminar.textContent = 'X';\r\n    btnEliminar.id = artistaId;\r\n    btnEliminar.onclick = function(){\r\n        div.removeChild(p);\r\n    }\r\n    //agregar el boton al div\r\n    \r\n    p.appendChild(btnEliminar);\r\n    div.appendChild(p);\r\n\r\n    //remove the value from the array if removed from the div usind the X button and read the array value again   \r\n\r\n    const btnEnviar = document.querySelector('#btn-artista');\r\n    btnEnviar.addEventListener('click', function(e){\r\n        //incrustar el valor del array en el input hidden\r\n        const artistasArray = [];\r\n        const artistas = document.querySelectorAll('.form__custom__input--artistas__p');\r\n        artistas.forEach(artista => {\r\n            artistasArray.push(artista.id);\r\n        });\r\n        const artistasInput = document.querySelector('#artsecundarios-hidden');\r\n        artistasInput.value = artistasArray.toString();\r\n        console.log(artistasInput.value);      \r\n    });\r\n}\r\n\r\nexport async function addArtist(){\r\n    const lang = await readLang();\r\n    const alerts = await readJSON();\r\n    btnAgregar.addEventListener('click', function(e){\r\n        e.preventDefault();\r\n         //crear modal para agregar formulario de artista\r\n        \r\n\r\n        const body = document.querySelector('body');\r\n        body.classList.add('overlay');\r\n\r\n        const divModal = document.createElement('div');\r\n        divModal.classList.add('register');\r\n\r\n        const modal = document.createElement('div');\r\n        modal.classList.add('register__modal');\r\n\r\n        const btnCerrar = document.createElement('button');\r\n        btnCerrar.classList.add('register__btn-cerrar');\r\n        btnCerrar.innerHTML = '<i class=\"fas fa-times\"></i>';\r\n        btnCerrar.onclick = cerrarModal;\r\n\r\n\r\n        const form = document.createElement('form');\r\n        form.classList.add('register__form');\r\n        form.id = 'form-artista';\r\n        form.autocomplete = 'off';\r\n\r\n        const h2 = document.createElement('h2');\r\n        h2.classList.add('register__title');\r\n        h2.textContent = alerts['addArtist'][lang];\r\n\r\n        const divInput = document.createElement('div');\r\n        divInput.classList.add('form__group');\r\n\r\n        const label = document.createElement('label');\r\n        label.classList.add('form__group__label');\r\n        label.htmlFor = 'nombre';\r\n        label.textContent = alerts['name'][lang];\r\n\r\n        const input = document.createElement('input');\r\n        input.classList.add('form__group__input');\r\n        input.type = 'text';\r\n        input.name = 'nombre';\r\n        input.id = 'artista-nombre';\r\n        input.addEventListener('blur', validarFormulario);\r\n        input.placeholder = alerts['name'][lang];\r\n\r\n        const sendBtn = document.createElement('input');\r\n        sendBtn.classList.add('btn-submit');\r\n        sendBtn.type = 'submit';\r\n        sendBtn.value = alerts['add'][lang];\r\n        sendBtn.onclick = enviarArtista;\r\n\r\n\r\n        divInput.appendChild(label);\r\n        divInput.appendChild(input);\r\n        form.appendChild(h2);\r\n        form.appendChild(divInput);\r\n        form.appendChild(sendBtn);\r\n        modal.appendChild(btnCerrar);\r\n        modal.appendChild(form);\r\n\r\n        divModal.appendChild(modal);\r\n        body.appendChild(divModal);\r\n\r\n    });\r\n}\r\n\r\nasync function enviarArtista(){\r\n    const input = document.querySelector('#artista-nombre');\r\n    const nombre = input.value;\r\n    const data = new FormData();\r\n\r\n    data.append('nombre', nombre);\r\n\r\n    try{\r\n        \r\n        const url = window.location.origin+'/api/albums/artistasNew';\r\n\r\n        const respuesta = await fetch(url, {\r\n            method: 'POST',\r\n            body: data,\r\n            mode: 'no-cors'\r\n        });\r\n\r\n        const resultado = await respuesta.json();        \r\n\r\n        if(resultado.resultado){\r\n            const lang = await readLang();\r\n            console.log(lang);\r\n            if(lang === 'es'){\r\n                alert('Artista agregado correctamente');\r\n            } else{\r\n                alert('Artist added successfully');\r\n            }\r\n            window.location.reload();\r\n        };\r\n    }catch(error){\r\n        const lang = await readLang();\r\n        if(lang === 'es'){\r\n            alert('Hubo un error');\r\n        } else{\r\n            alert('There was an error');\r\n        }\r\n    }\r\n}\r\n\r\nfunction cerrarModal(){\r\n    const body = document.querySelector('body');\r\n    const modal = document.querySelector('.register');\r\n    body.classList.remove('overlay');\r\n    modal.remove();\r\n}\r\n"]}