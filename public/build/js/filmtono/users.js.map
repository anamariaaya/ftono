{"version":3,"sources":["filmtono/users.js"],"names":["gridUsuarios","eliminarItem","readLang","readJSON","async","consultaUsuarios","resultado","fetch","window","location","origin","mostrarUsuarios","json","error","console","log","datos","lang","alerts","forEach","usuario","id","nombre","apellido","email","confirmado","perfil","nivel","tipo_es","tipo_en","empresa","tipoUsuario","document","createElement","classList","add","textContent","empresaUsuario","nombreUsuario","emailUsuario","estadoUsuario","estadoPerfil","btnInfo","href","iconoOjo","appendChild","btnEliminar","value","dataset","role","item","onclick","iconoBasura","contenedorBotones","card","filtrarUsuarios","querySelector","addEventListener","e","texto","target","toLowerCase","querySelectorAll","indexOf","style","display","marginRight","columnGap"],"mappings":"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","file":"users.js","sourcesContent":["import { gridUsuarios } from './selectores.js';\r\nimport { eliminarItem } from '../base/funciones.js';\r\nimport { readLang, readJSON } from '../base/funciones.js';\r\n\r\nexport async function consultaUsuarios(){\r\n    try{\r\n        const resultado = await fetch(window.location.origin+'/api/filmtono/users');\r\n        const datos = await resultado.json();\r\n        mostrarUsuarios(datos);\r\n\r\n    }catch(error){\r\n        console.log(error);\r\n    }\r\n}\r\nexport async function mostrarUsuarios(datos){\r\n        const lang = await readLang();\r\n        const alerts = await readJSON();\r\n        datos.forEach(usuario => {\r\n                const {id, nombre, apellido, email, confirmado, perfil, nivel, tipo_es, tipo_en, empresa} = usuario;\r\n\r\n                //generar la etiqueta para el tipo de usuario\r\n                const tipoUsuario = document.createElement('H3');\r\n                tipoUsuario.classList.add('card__title');\r\n                if(nivel != null){\r\n                        if(lang === 'es'){\r\n                                tipoUsuario.textContent = tipo_es;\r\n                        } else {\r\n                                tipoUsuario.textContent = tipo_en;\r\n                        }\r\n                }else{\r\n                        tipoUsuario.textContent = 'Admin';\r\n                }\r\n                \r\n                //generar la etiqueta para la empresa\r\n                const empresaUsuario = document.createElement('P');\r\n                empresaUsuario.classList.add('card__info--title');\r\n                empresaUsuario.textContent = empresa;\r\n\r\n\r\n                //generar la etiqueta para el nombre\r\n                const nombreUsuario = document.createElement('P');\r\n                nombreUsuario.classList.add('card__info');\r\n                nombreUsuario.textContent = nombre + ' ' + apellido;\r\n                \r\n                //generar la etiqueta para el email\r\n                const emailUsuario = document.createElement('P');\r\n                emailUsuario.classList.add('card__info');\r\n                emailUsuario.textContent = email;\r\n\r\n                //generar la etiqueta para el estado\r\n                const estadoUsuario = document.createElement('P');\r\n                estadoUsuario.classList.add('card__info--span');\r\n                if(confirmado==='1'){\r\n                        estadoUsuario.textContent = alerts['confirmed'][lang];\r\n                } else{\r\n                        estadoUsuario.textContent = alerts['not-confirmed'][lang];\r\n                }\r\n\r\n                const estadoPerfil = document.createElement('P');\r\n                estadoPerfil.classList.add('card__info--span');\r\n                if(perfil==='1'){\r\n                        estadoPerfil.textContent = alerts['profile-complete'][lang];\r\n                } else {\r\n                        estadoPerfil.textContent = alerts['profile-incomplete'][lang];\r\n                }\r\n\r\n                //generar el botón para abir el modal con la información del usuario\r\n                const btnInfo = document.createElement('A');\r\n                btnInfo.classList.add('btn-view');\r\n                btnInfo.textContent = alerts['see-more'][lang];\r\n                btnInfo.href = `/filmtono/users/current?id=${id}`;\r\n\r\n                //general ícono de ojo para el botón de ver más\r\n                const iconoOjo = document.createElement('I');\r\n                iconoOjo.classList.add('fa-solid', 'fa-eye');\r\n\r\n                //Agregar el ícono al botón\r\n                btnInfo.appendChild(iconoOjo);\r\n\r\n                //generar el botón para eliminar el usuario\r\n                const btnEliminar = document.createElement('BUTTON');\r\n                btnEliminar.classList.add('btn-delete');\r\n                btnEliminar.value = id;\r\n                btnEliminar.dataset.role = 'filmtono';\r\n                btnEliminar.dataset.item = 'users';\r\n                btnEliminar.onclick = eliminarItem;\r\n                \r\n                //generar ícono de basura para el botón de eliminar\r\n                const iconoBasura = document.createElement('I');\r\n                iconoBasura.classList.add('fa-solid', 'fa-trash-can', 'no-click');\r\n\r\n                //Agregar el ícono al botón\r\n                btnEliminar.appendChild(iconoBasura);\r\n                btnEliminar.onclick = eliminarItem;\r\n\r\n                //generar el contenedor de los botones\r\n                const contenedorBotones = document.createElement('DIV');\r\n                contenedorBotones.classList.add('card__acciones');\r\n\r\n                //agregar los botones al contenedor\r\n                contenedorBotones.appendChild(btnEliminar);\r\n\r\n                //Generar el contenedor de la información del usuario\r\n                const card = document.createElement('DIV');\r\n                card.classList.add('card');\r\n\r\n                //agregar la información al contenedor\r\n                card.appendChild(tipoUsuario);\r\n                if(empresa){\r\n                        card.appendChild(empresaUsuario);\r\n                }\r\n                card.appendChild(nombreUsuario);\r\n                card.appendChild(emailUsuario);\r\n                card.appendChild(estadoUsuario);\r\n                if(nivel != null){\r\n                        card.appendChild(estadoPerfil);\r\n                }\r\n                card.appendChild(empresaUsuario);\r\n                card.appendChild(btnInfo);\r\n                card.appendChild(contenedorBotones);\r\n\r\n                //agregar el contenedor de la información al grid\r\n                gridUsuarios.appendChild(card);\r\n        });\r\n        filtrarUsuarios();\r\n}\r\n\r\nfunction filtrarUsuarios(){\r\n        const input = document.querySelector('#usuario-search');\r\n        input.addEventListener('input', e => {\r\n                const texto = e.target.value.toLowerCase();\r\n                console.log(texto);\r\n                const cards = document.querySelectorAll('.card');\r\n\r\n                cards.forEach(card => {\r\n                        const nombre = card.textContent.toLowerCase();\r\n                        if(nombre.indexOf(texto) !== -1){\r\n                                card.style.display = 'flex';\r\n                                card.style.marginRight = '2rem';\r\n                                gridUsuarios.style.columnGap = '0';\r\n                        }else{\r\n                                card.style.display = 'none';\r\n                        }\r\n                });\r\n        }); \r\n}"]}